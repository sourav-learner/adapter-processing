<?xml version="1.0" encoding="UTF-8"?>
<Adapter Name="Rated-TAPIN" Type="ASCII" Version="1.0" Active="true" StatusDBHandler="mongo" rawJson="false"
         decoderExecClass="com.gamma.skybase.build.server.etl.decoder.tap.rated.RatedTapinFileExecutor" ExecMode="server"
         txExecClass="com.gamma.skybase.build.server.etl.tx.tap.rated.RatedTapinRecordEnrichment" ignoreLogging="false"
         ignoreDuplicates="false" parallel="1" instance-size="1" load-factor="1" customized="enable">

    <!--Extraction tag-->
    <Extraction type="sniff" protocol="local"
                execClass="com.gamma.skybase.server.core.collector.sniff.DefaultSniffingExtractionAgent">
        <Settings host="" port="" path="data/rated-tapin/poll" username="" password="">
            <Signature required="false" key=""/>
            <Extract pattern="(.+)\\_(\\d{8})(\\d{6})\\_(\\d*).*"
                     metaFields="fileName\,prefix1\,fileDate\,fileTime\,fileSequence" dateFieldPattern="yyyyMMdd"/>
        </Settings>
    </Extraction>

    <DirConfig>
        <Source  path="data/rated-tapin/source" clogging="true"/>
        <Backup  path="data/rated-tapin/backup" clogging="true" compress="gz"/>
        <Staging path="data/rated-tapin/staging" clogging="true"/>
        <Output  path="data/rated-tapin/output" clogging="true"/>
        <Error   path="data/rated-tapin/error" clogging="true"/>
        <Target protocol="" host="" path="/" pwd="" user="" active="true"/>
    </DirConfig>

    <DataDef>
        <Event eventName="RATED_TAPIN_FCT" tableName="RATED_TAPIN_FCT" synonym="RATED_TAPIN_FCT" dataBase="hive">
            <Field sourceFieldName="event_date"                     targetFieldName="EVENT_TIME"        dataType="date" SourceFormat="yyyyMMdd HH:mm:ss" default="19700101 00:00:01"/>
            <Field sourceFieldName="start_time_timestamp"           targetFieldName="START_TIME_CHARGE" dataType="date" SourceFormat="yyyyMMdd HH:mm:ss" default="19700101 00:00:01"/>
            <Field sourceFieldName="start_time_offset"              targetFieldName="START_TIME_OFFSET"/>
            <Field sourceFieldName="s_p_number_address"             targetFieldName="SP_NUMBER"/>
            <Field sourceFieldName="s_p_equipment_number"           targetFieldName="SP_EQUIPMENT_NUMBER"/>
            <Field sourceFieldName="s_p_port_address"               targetFieldName="SP_PORT_ADDRESS"/>
            <Field sourceFieldName="o_p_number_address"             targetFieldName="OP_NUMBER"/>
            <Field sourceFieldName="duration_volume"                targetFieldName="DURATION_VOLUME"     dataType="double" default="0"/>
            <Field sourceFieldName="rated_volume"                   targetFieldName="RATED_VOLUME"        dataType="double" default="0"/>
            <Field sourceFieldName="rounded_volume"                 targetFieldName="ROUNDED_VOLUME"      dataType="double" default="0"/>
            <Field sourceFieldName="rated_flat_amount"              targetFieldName="RATED_FLAT_AMOUNT"   dataType="double" default="0"/>
            <Field sourceFieldName="call_type"                      targetFieldName="CALL_TYPE"/>
            <Field sourceFieldName="tariff_info_sncode"             targetFieldName="TARIFF_INFO_SNCODE"/>
            <Field sourceFieldName="xfile_ind"                      targetFieldName="XFILE_IND"/>
            <Field sourceFieldName="imp_party1_bill_cycle"          targetFieldName="BILL_CYCLE"/>
            <Field sourceFieldName="net_element_address"            targetFieldName="NET_ELEMENT_ADDRESS"/>
            <Field sourceFieldName="bop_tariff_info_sncode"         targetFieldName="BOP_TARIFF_INFO_SNCODE"/>
            <Field sourceFieldName="EVENT_TYPE_KEY"              default="-99"/>
            <Field sourceFieldName="EVENT_DIRECTION_KEY"         default="-99"/>
            <Field sourceFieldName="SRV_TYPE_KEY"                default="-99"/>
            <Field sourceFieldName="SERVED_MSISDN"               default=""/>
            <Field sourceFieldName="PARTNER_COUNTRY_ISO"         default="-99"/>
            <Field sourceFieldName="PARTNER_OPER"                default="UNKNOWN"/>
            <Field sourceFieldName="OTHER_MSISDN"/>
            <Field sourceFieldName="OTHER_MSISDN_DIAL_DIGIT"/>
            <Field sourceFieldName="OTHER_MSISDN_ISO_CODE"       default="-99"/>
            <Field sourceFieldName="OTHER_MSISDN_OPER"           default="UNKNOWN"/>
            <Field sourceFieldName="POPULATION_DATE"     dataType="date" SourceFormat="yyyyMMdd HH:mm:ss" default="19700101 00:00:01"/>
            <Field sourceFieldName="XDR_DATE"            dataType="date" SourceFormat="yyyyMMdd HH:mm:ss" default="19700101 00:00:01"/>
            <Field sourceFieldName="fileName"            targetFieldName="FILE_NAME"/>
        </Event>
    </DataDef>
</Adapter>
